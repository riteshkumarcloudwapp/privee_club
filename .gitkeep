// NOTES
// UTILS - reusable code is in the utils folder like multer etc.

// dotenv - all sensetive data are kept .
// where we put db config and server related environment variable.

// So insted of writing
// Import dotenv from .env
// then config dotenv file
// we push all the env var into a common env configuration file.
// then use it .

//DB connection
//1Ô∏è‚É£ Install required packages
//2Ô∏è‚É£ .env file (Database config)
//3Ô∏è‚É£ envconfig.js
//4Ô∏è‚É£ Create Sequelize instance

// Always use fcm token in user resgister and login. *always add language filed in it.
// Make single Api through type and value fieds in json.(In postman)(eg. selfie and bestPic)
// use type and value method.

//always use joi module for validation of request body and query params. 
// and also pagination whenever you get data and make a list of data.


//NOTES
// Always make a seperate image table for image and use increnment way to store image.
// Becs increnment way is much better than comma seperated becs operation is easy on it.
// when yyou want to bilk upload anything  at ones always use map function for it.
// always use increnment way to store id.


//Register user
Validate data
Check user exist
Generate OTP
Store OTP
Send OTP
Create user ONLY after OTP verification

OTP in registration is used to:

‚úÖ Verify ownership

‚úÖ Prevent fake accounts

‚úÖ Increase security

‚úÖ Activate account safely

‚úÖ Enable password reset later



What is a Templating Engine?

A templating engine allows you to:

Write normal HTML

Insert dynamic data inside it

Render it from backend

üìå What is Handlebars (HBS)?

Handlebars is:

A simple HTML templating engine

Logic-less (very minimal logic inside HTML)

Commonly used with Express

It uses {{ }} syntax.


// Email sending steps
1.Install Nodemailer -> its a mail sending nodejs library. This package enables us to send emails from our Node.js applications using various email services (like Gmail, Outlook, etc.)to other people
2.Create a Transporter Object ->  This object contains the configuration for your email service's SMTP server and your authentication details.
const nodemailer = require('nodemailer');

const transporter = nodemailer.createTransport({
  service: 'gmail', // Use well-known service name or specify host/port
  auth: {
    user: 'your-email@gmail.com', // Your email address
    pass: 'your-app-password'   // Your generated App Password
  }
});

3.Define Mail Options -> Create an object that defines the content and recipients of the email.
const mailOptions = {
  from: '"Your Name" <your-email@gmail.com>', // Sender address and name
  to: 'recipient-email@example.com, another-recipient@example.com', // List of receivers (comma-separated or array)
  subject: 'Hello from Nodemailer!', // Subject line
  text: 'This is the plain text body of the email.', // Plain text body
  html: '<b>This is the HTML body of the email.</b>' // HTML body (optional)
};

4.Send the Email -> Use the transporter.sendMail() method, passing the mailOptions object and a callback function to handle the response or any errors.
transporter.sendMail(mailOptions, (error, info) => {
  if (error) {
    console.error('Error sending email:', error);
  } else {
    console.log('Email sent:', info.response);
  }
});


//////////////////////////////////////
./ ‚Üí current folder

../ ‚Üí parent folder


/////////////////////////////////////////
1Ô∏è‚É£ What is __dirname?
It gives you the absolute path of the current file‚Äôs directory. ->/home/ritesh/project/routes/user.js

‚úÖ 2Ô∏è‚É£ What is path.join()?

path.join() comes from Node's built-in Node.js path module.

It safely joins multiple path segments into one correct path for your OS.



//////////////////////////////////////
Why Use process.cwd() Instead of __dirname?

If this code is inside server.js (root file):

Both usually work.

But if it's inside another folder (like config/app.js):

__dirname ‚Üí gives that file's folder

process.cwd() ‚Üí gives project root

For static folders in root or server, process.cwd() is often safer.



üç™ 1Ô∏è‚É£ Session + Cookie (Traditional Way - Best for EJS)


// cookie with token 
üîë 2Ô∏è‚É£ JWT + Cookie (Token-Based)
üîπ How it works:

User logs in

Server generates a JWT token

Token contains user data inside it

Token is sent in cookie:  token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

On every request: cookie is sent to server and server verifies token

Server verifies token

If valid ‚Üí user authenticated



// SESSION WITH COOKIE
1Ô∏è‚É£ User logs in  
2Ô∏è‚É£ Server creates a session (stores user data in memory or database)    -> sessionId=abc123
3Ô∏è‚É£ Server sends a cookie with session ID to the client
4Ô∏è‚É£ Client stores cookie and sends it with every request
5Ô∏è‚É£ Server checks session ID from cookie, retrieves session data, and authenticates user

// express-session + connect-flash

Flash messages work using:

express-session

connect-flash

They are used for:

Login success

Login error

Delete success

Update success

etc.